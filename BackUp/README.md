# LoneSword 
![icon-1024](https://github.com/user-attachments/assets/ce694f23-46db-46a4-9c7e-a0ae6a1cfbe4)


LoneSword: An Efficient Information Browsing Tool for Discerning Truth in the AI Era.

ç”¨AIå¯¹æŠ—AIæ—¶ä»£çš„ç½‘ç»œç†µå¢,ä¸€ä¸ªåŸºäºSwiftUIå’ŒWebKitçš„ç°ä»£iOSæµè§ˆå™¨åº”ç”¨ï¼Œå½“å‰åªå®Œæˆæµè§ˆå™¨åŸºæœ¬åŠŸèƒ½ï¼ŒAIåŠŸèƒ½å¼€å‘ä¸­ã€‚

## åŠŸèƒ½ç‰¹æ€§

### ğŸŒ æµè§ˆå™¨ç•Œé¢
- **æ™ºèƒ½åœ°å€æ **: è‡ªåŠ¨æ ¼å¼åŒ–åŸŸåï¼Œæ ¹æ®éœ€è¦æ·»åŠ  `http://`ã€`https://`ã€`www.`
- **å¯¼èˆªæŒ‰é’®**: å‰è¿›/åé€€æŒ‰é’®ï¼Œæœ‰å†å²è®°å½•æ—¶æ˜¾ç¤ºè“è‰²å¯ç‚¹å‡»ï¼Œæ— å†å²æ—¶æ˜¾ç¤ºç°è‰²ä¸å¯ç‚¹å‡»
- **SlashæŒ‰é’®**: è“è‰²æŒ‰é’®ï¼Œç‚¹å‡»æ—¶åœæ­¢å½“å‰åŠ è½½å¹¶å¼€å§‹åŠ è½½åœ°å€æ ä¸­çš„URL
- **UserAgentåˆ‡æ¢**: å¤šæ¨¡å¼å¾ªç¯åˆ‡æ¢æŒ‰é’®ï¼Œæ”¯æŒ4ç§ä¸åŒçš„UserAgent
  - **SF** (è“è‰²): Safari UserAgentï¼Œä¸iOS Safariå®Œå…¨ç›¸åŒ
  - **LS** (æ©™è‰²): LoneSword Browser UserAgentï¼Œè‡ªå®šä¹‰å“ç‰Œæ ‡è¯†
  - **CI** (ç»¿è‰²): Chrome iOS UserAgentï¼Œæ¨¡æ‹ŸiOSç‰ˆChromeæµè§ˆå™¨
  - **CP** (çº¢è‰²): Chrome PC UserAgentï¼Œæ¨¡æ‹ŸWindowsç‰ˆChromeæµè§ˆå™¨
- **å¤šé€‰é¡¹åŠŸèƒ½**: ä¸‰ä¸ªå¯é€‰åŠŸèƒ½ï¼ˆç¿»è¯‘ã€AIæ€»ç»“ã€AIåˆ¤åˆ«ï¼‰ï¼Œé»˜è®¤æœªé€‰ä¸­ï¼Œé€‰ä¸­æ—¶æ˜¾ç¤ºè“è‰²å‹¾é€‰çŠ¶æ€
- **è¿›åº¦æ¡**: é¡¶éƒ¨2åƒç´ çš„ç½‘é¡µåŠ è½½è¿›åº¦æ¡ï¼Œä»å±å¹•æœ€å·¦ä¾§åˆ°æœ€å³ä¾§ï¼Œæ ¹æ®åŠ è½½ç™¾åˆ†æ¯”åŠ¨æ€è°ƒæ•´

### ğŸ“± WebViewé›†æˆ
- åœ°å€æ ä¸‹æ–¹æ•´ä¸ªå±å¹•åŒºåŸŸä¸ºWebView
- æ­£ç¡®çš„URLåŠ è½½å’Œåœæ­¢åŠŸèƒ½
- URLåŠ è½½è¿›åº¦å…³è”é¡¶éƒ¨è¿›åº¦æ¡é•¿åº¦
- æ”¯æŒæ‰‹åŠ¿å¯¼èˆªï¼ˆå·¦å³æ»‘åŠ¨å‰è¿›åé€€ï¼‰
- æ”¯æŒå†…è”åª’ä½“æ’­æ”¾

### ğŸ“š URLå†å²è®°å½•ç®¡ç†
- å®Œæ•´çš„æµè§ˆå†å²è®°å½•ï¼Œæ”¯æŒå‰è¿›/åé€€å¯¼èˆª
- è‡ªåŠ¨URLå¤„ç†ï¼ˆæ ¹æ®éœ€è¦æ·»åŠ åè®®å’Œwwwå‰ç¼€ï¼‰
- å¯¼èˆªæ—¶åœ°å€æ è‡ªåŠ¨æ›´æ–°
- æ™ºèƒ½æœç´¢ï¼šè¾“å…¥éURLæ ¼å¼å†…å®¹æ—¶è‡ªåŠ¨ä½¿ç”¨Googleæœç´¢

## æŠ€æœ¯å®ç°

### æ¶æ„
- **SwiftUI**: ç°ä»£å£°æ˜å¼UIæ¡†æ¶
- **WebKit**: åŸç”ŸWebæµè§ˆå¼•æ“
- **MVVMæ¨¡å¼**: æ¸…æ™°çš„æ•°æ®ç»‘å®šå’ŒçŠ¶æ€ç®¡ç†
- **Combine**: å“åº”å¼ç¼–ç¨‹å¤„ç†çŠ¶æ€æ›´æ–°

### æ ¸å¿ƒç»„ä»¶
1. **ContentView**: ä¸»è§†å›¾å®¹å™¨
2. **BrowserToolbar**: å·¥å…·æ ç»„ä»¶ï¼ˆåœ°å€æ ã€å¯¼èˆªæŒ‰é’®ã€é€‰é¡¹ï¼‰
3. **WebViewContainer**: WebKité›†æˆç»„ä»¶
4. **ProgressBar**: åŠ è½½è¿›åº¦æŒ‡ç¤ºå™¨
5. **BrowserViewModel**: ä¸šåŠ¡é€»è¾‘å’ŒçŠ¶æ€ç®¡ç†

### æ™ºèƒ½URLå¤„ç†
```swift
// è‡ªåŠ¨æ·»åŠ åè®®
if !urlString.hasPrefix("http://") && !urlString.hasPrefix("https://") {
    urlString = "https://" + urlString
}

// æ™ºèƒ½æ·»åŠ wwwå‰ç¼€
if host.components(separatedBy: ".").count == 2 && !host.hasPrefix("www.") {
    urlString = urlString.replacingOccurrences(of: "://\(host)", with: "://www.\(host)")
}

// æœç´¢æŸ¥è¯¢æ£€æµ‹
if !urlString.contains(".") || urlString.contains(" ") {
    return "https://www.google.com/search?q=" + encodedQuery
}
```

### UserAgent ç®¡ç†
```swift
// UserAgentç±»å‹æšä¸¾
enum UserAgentType: Int, CaseIterable {
    case safari = 0      // Safari UserAgent
    case loneSword = 1   // LoneSword Browser UserAgent  
    case chromeIOS = 2   // Chrome iOS UserAgent
    case chromePC = 3    // Chrome PC UserAgent
}

// åŠ¨æ€è®¾å¤‡ä¿¡æ¯è·å–
class DeviceInfo {
    var iosVersion: String { UIDevice.current.systemVersion.replacingOccurrences(of: ".", with: "_") }
    var isIPad: Bool { UIDevice.current.userInterfaceIdiom == .pad }
    
    var safariUserAgent: String {
        if isIPad {
            return "Mozilla/5.0 (iPad; CPU OS \(iosVersion) like Mac OS X) AppleWebKit/605.1.15..."
        } else {
            return "Mozilla/5.0 (iPhone; CPU iPhone OS \(iosVersion) like Mac OS X) AppleWebKit/605.1.15..."
        }
    }
}

// å¾ªç¯åˆ‡æ¢ UserAgent
func toggleUserAgent() {
    let allCases = UserAgentType.allCases
    let currentIndex = allCases.firstIndex(of: currentUserAgentType) ?? 0
    let nextIndex = (currentIndex + 1) % allCases.count
    currentUserAgentType = allCases[nextIndex]
}
```

## å®‰è£…å’Œè¿è¡Œ

### ç³»ç»Ÿè¦æ±‚
- iOS 15.0+
- Xcode 14.0+
- Swift 5.7+

### æ„å»ºæ­¥éª¤
1. å…‹éš†æˆ–ä¸‹è½½é¡¹ç›®
2. åœ¨Xcodeä¸­æ‰“å¼€ `LoneSword.xcodeproj`
3. é€‰æ‹©ç›®æ ‡è®¾å¤‡æˆ–æ¨¡æ‹Ÿå™¨
4. ç‚¹å‡»è¿è¡ŒæŒ‰é’®æˆ–æŒ‰ `Cmd+R`

### é…ç½®è¯´æ˜
é¡¹ç›®å·²é…ç½®äº†å¿…è¦çš„ç½‘ç»œå®‰å…¨ä¼ è¾“è®¾ç½®ï¼ˆ`Info.plist`ï¼‰ï¼š
- `NSAllowsArbitraryLoads`: å…è®¸åŠ è½½ä»»æ„ç½‘ç«™
- `NSAllowsArbitraryLoadsInWebContent`: å…è®¸WebViewåŠ è½½ä»»æ„å†…å®¹

## ä½¿ç”¨æ–¹æ³•

### åŸºæœ¬æµè§ˆ
1. åœ¨åœ°å€æ è¾“å…¥ç½‘å€æˆ–æœç´¢å…³é”®è¯
2. æŒ‰å›è½¦é”®æˆ–ç‚¹å‡»"Slash"æŒ‰é’®å¼€å§‹åŠ è½½
3. ä½¿ç”¨å‰è¿›/åé€€æŒ‰é’®å¯¼èˆªå†å²è®°å½•
4. è§‚å¯Ÿé¡¶éƒ¨è¿›åº¦æ¡äº†è§£åŠ è½½çŠ¶æ€

### UserAgent ç®¡ç†
1. ç‚¹å‡»å·¥å…·æ ä¸­çš„ UserAgent æŒ‰é’®å¾ªç¯åˆ‡æ¢ä¸åŒæ¨¡å¼
2. **SF** (è“è‰²): Safari UserAgentï¼Œç½‘ç«™è¯†åˆ«ä¸ºiOS Safariæµè§ˆå™¨
3. **LS** (æ©™è‰²): LoneSword Browser UserAgentï¼Œç½‘ç«™è¯†åˆ«ä¸ºLoneSwordæµè§ˆå™¨
4. **CI** (ç»¿è‰²): Chrome iOS UserAgentï¼Œç½‘ç«™è¯†åˆ«ä¸ºiOSç‰ˆChromeæµè§ˆå™¨
5. **CP** (çº¢è‰²): Chrome PC UserAgentï¼Œç½‘ç«™è¯†åˆ«ä¸ºWindowsç‰ˆChromeæµè§ˆå™¨
6. iOSç‰ˆæœ¬çš„UserAgentä¼šè‡ªåŠ¨è·å–å½“å‰è®¾å¤‡çš„çœŸå®ä¿¡æ¯ï¼ˆè®¾å¤‡å‹å·ã€iOSç‰ˆæœ¬ç­‰ï¼‰
7. å¯ä»¥è®¿é—® `localhost:8080/test_useragent.html` æµ‹è¯•UserAgentæ•ˆæœ

### æ™ºèƒ½è¾“å…¥ç¤ºä¾‹
- `google.com` â†’ `https://www.google.com`
- `github.com` â†’ `https://www.github.com`
- `hello world` â†’ Googleæœç´¢"hello world"
- `https://example.com` â†’ ç›´æ¥åŠ è½½

### åŠŸèƒ½é€‰é¡¹ï¼ˆè¿˜æœªå®ç°åŠŸèƒ½ï¼‰
- **ç¿»è¯‘**: å¯ç”¨ç½‘é¡µç¿»è¯‘åŠŸèƒ½
- **AIæ€»ç»“**: å¯ç”¨AIå†…å®¹æ€»ç»“
- **AIåˆ¤åˆ«**: å¯ç”¨AIå†…å®¹åˆ¤åˆ«

## é¡¹ç›®ç»“æ„

```
LoneSword/
â”œâ”€â”€ LoneSword/
â”‚   â”œâ”€â”€ LoneSwordApp.swift      # åº”ç”¨å…¥å£ç‚¹
â”‚   â”œâ”€â”€ ContentView.swift       # ä¸»è§†å›¾å’Œæ‰€æœ‰ç»„ä»¶
â”‚   â”œâ”€â”€ Info.plist             # åº”ç”¨é…ç½®
â”‚   â””â”€â”€ Assets.xcassets/       # åº”ç”¨èµ„æº
â”œâ”€â”€ LoneSwordTests/            # å•å…ƒæµ‹è¯•
â”œâ”€â”€ LoneSwordUITests/          # UIæµ‹è¯•
â””â”€â”€ LoneSword.xcodeproj/       # Xcodeé¡¹ç›®æ–‡ä»¶
```

## ç‰¹è‰²åŠŸèƒ½

### ğŸ¯ æ™ºèƒ½è¿›åº¦æ¡
- ä»…åœ¨åŠ è½½æ—¶æ˜¾ç¤ºï¼ˆ0% < è¿›åº¦ < 100%ï¼‰
- å¹³æ»‘åŠ¨ç”»æ•ˆæœ
- åŠ è½½å®Œæˆåè‡ªåŠ¨éšè—

### ğŸ”§ UserAgent ç®¡ç†
- **å››æ¨¡å¼å¾ªç¯åˆ‡æ¢**: Safari â†’ LoneSword â†’ Chrome iOS â†’ Chrome PC
- **æ™ºèƒ½è®¾å¤‡è¯†åˆ«**: iOSç‰ˆæœ¬UserAgentè‡ªåŠ¨è·å–çœŸå®è®¾å¤‡ä¿¡æ¯
- **å®æ—¶ç”Ÿæ•ˆ**: åˆ‡æ¢åç«‹å³åº”ç”¨åˆ°æ‰€æœ‰æ–°è¯·æ±‚
- **è§†è§‰æŒ‡ç¤º**: SF(è“è‰²) / LS(æ©™è‰²) / CI(ç»¿è‰²) / CP(çº¢è‰²) æŒ‰é’®çŠ¶æ€æ¸…æ™°
- **å…¼å®¹æ€§ä¼˜å…ˆ**: é»˜è®¤ä½¿ç”¨Safari UserAgentç¡®ä¿æœ€ä½³å…¼å®¹æ€§

### ğŸ”„ å†…å­˜ç®¡ç†
- ä½¿ç”¨weakå¼•ç”¨é¿å…å¾ªç¯å¼•ç”¨
- æ­£ç¡®çš„KVOè§‚å¯Ÿè€…ç®¡ç†
- è‡ªåŠ¨æ¸…ç†èµ„æº

### ğŸ¨ ç”¨æˆ·ä½“éªŒ
- å“åº”å¼è®¾è®¡é€‚é…ä¸åŒå±å¹•å°ºå¯¸
- ç›´è§‚çš„è§†è§‰åé¦ˆ
- æµç•…çš„åŠ¨ç”»è¿‡æ¸¡
- é”®ç›˜å‹å¥½çš„è¾“å…¥ä½“éªŒ

### è‡ªå®šä¹‰é€‰é¡¹
ä¸‰ä¸ªå¤šé€‰é¡¹åŠŸèƒ½å¯ä»¥æ ¹æ®éœ€è¦å®ç°å…·ä½“é€»è¾‘ï¼š
```swift
// åœ¨BrowserViewModelä¸­æ·»åŠ åŠŸèƒ½é€»è¾‘
@Published var option1: Bool = false // ç¿»è¯‘
@Published var option2: Bool = false // AIæ€»ç»“  
@Published var option3: Bool = false // AIåˆ¤åˆ«
```

## è®¸å¯è¯
MITåè®®ï¼

## è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestæ¥æ”¹è¿›è¿™ä¸ªé¡¹ç›®ã€‚

---
